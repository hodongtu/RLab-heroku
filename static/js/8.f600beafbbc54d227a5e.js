webpackJsonp([8],{HgUX:function(e,t){},OArB:function(e,t){},VhrE:function(e,t,n){"use strict";var a=n("Dd8w"),r=n.n(a),i=n("ye7G"),l=n("NYxO"),s={props:{type:Object,required:!0},computed:r()({},Object(l.c)("RMC",["dialogNewEntityVisible"])),data:function(){return{form:{long_name:null,alias:null,system_id:null,legal_id:null,tax_code:null,registration_number:null},rules:{long_name:[{required:!0,message:"Please input",trigger:"blur"}],alias:[{required:!0,message:"Please input",trigger:"blur"}],tax_code:[{required:!0,message:"Please input",trigger:"blur"}]},loading:!1,options:[]}},methods:r()({},Object(l.d)("RMC",["TOGGLE_NEW_ENTITY_DIALOG"]),{submit:function(e,t){var n=this;this.$refs[e].validate(function(e){return e&&(n.form.type=n.type.id,console.log(n.form),t||n.TOGGLE_NEW_ENTITY_DIALOG()),!1})}})},o={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{visible:e.dialogNewEntityVisible,"before-close":e.TOGGLE_NEW_ENTITY_DIALOG,width:"35%",title:"Create new entity"}},[n("el-form",{ref:"newEntityForm",attrs:{model:e.form,rules:e.rules,"label-width":"150px",size:"mini","label-position":"left"}},[n("el-form-item",{attrs:{label:"Long name",prop:"long_name"}},[n("el-input",{model:{value:e.form.long_name,callback:function(t){e.$set(e.form,"long_name",t)},expression:"form.long_name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"Alias",prop:"alias"}},[n("el-input",{model:{value:e.form.alias,callback:function(t){e.$set(e.form,"alias",t)},expression:"form.alias"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"Tax code",prop:"tax_code"}},[n("el-input",{model:{value:e.form.tax_code,callback:function(t){e.$set(e.form,"tax_code",t)},expression:"form.tax_code"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"System ID",prop:"system_id"}},[n("el-input",{model:{value:e.form.system_id,callback:function(t){e.$set(e.form,"system_id",t)},expression:"form.system_id"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"Legal ID",prop:"legal_id"}},[n("el-input",{model:{value:e.form.legal_id,callback:function(t){e.$set(e.form,"legal_id",t)},expression:"form.legal_id"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"Registration number",prop:"registration_number"}},[n("el-input",{model:{value:e.form.registration_number,callback:function(t){e.$set(e.form,"registration_number",t)},expression:"form.registration_number"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"Entity type",prop:"type"}},[n("span",[e._v(e._s(e.type?e.type.value:""))])])],1),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.submit("newEntityForm",!1)}}},[e._v("Save")]),e._v(" "),n("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.submit("newEntityForm",!0)}}},[e._v("Save & Add Another")]),e._v(" "),n("el-button",{attrs:{size:"small"},on:{click:e.TOGGLE_NEW_ENTITY_DIALOG}},[e._v("Cancel")])],1)],1)},staticRenderFns:[]};var c={name:"RMCSearchResult",components:{NewEntityDialog:n("VU/8")(s,o,!1,function(e){n("sWum")},"data-v-5444caf9",null).exports},directives:{permission:n("je39").a},props:{allowCreate:{type:Boolean,default:!1},allowView:{type:Boolean,default:!1},allowRequest:{type:Boolean,default:!1}},mounted:function(){var e=this;this.allowCreate&&this.$services.RMCReference.get("entity_types").then(function(t){return e.entity_types=t.data})},computed:r()({},Object(l.c)("RMC",["entitySearchLoading","entitySearchResult"]),Object(i.b)("RMC",["entitySearchForm.page_size","entitySearchForm.page_number"]),{generateIndex:function(){return 1===this.page_number?this.page_number:(this.page_number-1)*this.page_size+1}}),data:function(){return{currentEntity:null,entity_type:null,entity_types:[],columnDefs:[{label:"Long name",prop:"long_name",sortable:!0,width:300},{label:"Alias",prop:"short_name",sortable:!0},{label:"Entity type",prop:"entity_type",sortable:!0},{label:"Business type",prop:"business_type",sortable:!0},{label:"T24 system ID",prop:"T24_system_id",sortable:!0},{label:"Legal ID",prop:"legal_id",sortable:!0},{label:"Tax code",prop:"tax_code",sortable:!0},{label:"Registration number",prop:"registration_number",sortable:!0},{label:"Stock code",prop:"stock_code",sortable:!0}],request_types:[{value:"Whole Group",id:"whole_group"},{value:"Only Childrens",id:"only_childrens"},{value:"Only Parents",id:"only_parents"},{value:"Only Stakeholder",id:"stakeholder"}],popoverVisible:!1,request_type:null,options:[{value:"guide",label:"Request type",disabled:!0},{label:"Whole Group",value:"whole_group"},{label:"Only Childrens",value:"only_childrens"},{label:"Only Parents",value:"only_parents"},{label:"Only Stakeholder",value:"stakeholder"}]}},methods:r()({},Object(l.d)("RMC",["TOGGLE_NEW_ENTITY_DIALOG","ENTITY_SEARCH_LOADING"]),{createEntity:function(e){this.entity_type=e,this.TOGGLE_NEW_ENTITY_DIALOG()},createRequest:function(){this.$store.dispatch("RMC/addRequest",{entity_id:this.currentEntity.id,type:this.request_type}).then(function(e){return console.log(e)})},view:function(){this.currentEntity&&this.$router.push({path:"/rmc/entity/"+this.currentEntity.id})},handleCurrentChange:function(e){this.currentEntity=e},currentPageChange:function(e){this.page_number=e,this.$store.dispatch("RMC/searchEntity")},sizeChange:function(e){this.page_size=e,this.$store.dispatch("RMC/searchEntity")},onChangeCascader:function(){var e=this;this.$confirm("Are you sure?","Confirm",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(function(){console.log(e.request_type),e.popoverVisible=!1})}})},u={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"mx-3"},[n("div",{staticClass:"mb-2"},[e.allowCreate?n("el-dropdown",{directives:[{name:"permission",rawName:"v-permission",value:["superuser","RMCAdmin"],expression:"['superuser', 'RMCAdmin']"}],attrs:{trigger:"click",placement:"bottom-start"},on:{command:e.createEntity}},[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"Create entity",placement:"top-start"}},[n("el-button",{attrs:{disabled:e.entitySearchLoading||!e.entity_types.length,size:"mini",icon:"icon icon-plus",plain:""}})],1),e._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.entity_types,function(t){return n("el-dropdown-item",{key:t.id,attrs:{command:t}},[e._v("\n          "+e._s(t.value)+"\n        ")])}),1)],1):e._e(),e._v(" "),e.allowRequest?n("el-popover",{attrs:{placement:"right",trigger:"click"},model:{value:e.popoverVisible,callback:function(t){e.popoverVisible=t},expression:"popoverVisible"}},[n("el-cascader-panel",{attrs:{options:e.options,clearable:""},on:{change:e.onChangeCascader},model:{value:e.request_type,callback:function(t){e.request_type=t},expression:"request_type"}}),e._v(" "),n("el-button",{attrs:{slot:"reference",disabled:e.entitySearchLoading||!e.currentEntity,size:"mini",icon:"icon icon-plus",plain:""},slot:"reference"})],1):e._e(),e._v(" "),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"View",placement:"top-start"}},[e.allowView?n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["superuser","RMCAdmin"],expression:"['superuser', 'RMCAdmin']"}],attrs:{size:"mini",icon:"icon icon-folder-open",plain:"",disabled:e.entitySearchLoading||!e.currentEntity},on:{click:e.view}}):e._e()],1)],1),e._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.entitySearchLoading,expression:"entitySearchLoading"}],attrs:{data:e.entitySearchResult.items,"element-loading-text":"Loading...",size:"mini",border:"","highlight-current-row":""},on:{"current-change":e.handleCurrentChange}},[n("el-table-column",{attrs:{type:"index",width:"35",align:"center",index:e.generateIndex}}),e._v(" "),e._l(e.columnDefs,function(e,t){return n("el-table-column",{key:t,attrs:{label:e.label,width:e.width,prop:e.prop,sortable:e.sortable}})})],2),e._v(" "),e.entitySearchResult.total?n("el-pagination",{staticClass:"mt-2",attrs:{disabled:e.entitySearchLoading,total:e.entitySearchResult.total,"page-sizes":[20,50,100],"page-size":e.page_size,"current-page":e.page_number,layout:"total, sizes, prev, pager, next, jumper",background:""},on:{"current-change":e.currentPageChange,"size-change":e.sizeChange}}):e._e(),e._v(" "),n("NewEntityDialog",{attrs:{type:e.entity_type}})],1)},staticRenderFns:[]};var m=n("VU/8")(c,u,!1,function(e){n("OArB")},null,null);t.a=m.exports},"YdM+":function(e,t,n){"use strict";var a=n("Dd8w"),r=n.n(a),i=n("ye7G"),l={name:"RMCSearchCriteria",computed:r()({},Object(i.b)("RMC",["entitySearchForm","entitySearchForm.long_name","entitySearchForm.short_name","entitySearchForm.T24_system_id","entitySearchForm.legal_id","entitySearchForm.tax_code","entitySearchForm.registration_number"]))},s={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-row",{attrs:{gutter:30}},[n("el-form",{attrs:{model:e.entitySearchForm,"label-position":"left","label-width":"150px",size:"mini"}},[n("el-col",{attrs:{xs:24,sm:12,md:8,lg:8,xl:8}},[n("el-form-item",{attrs:{label:"Long name"}},[n("el-input",{model:{value:e.long_name,callback:function(t){e.long_name=t},expression:"long_name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"System ID"}},[n("el-input",{model:{value:e.T24_system_id,callback:function(t){e.T24_system_id=t},expression:"T24_system_id"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"Legal ID"}},[n("el-input",{model:{value:e.legal_id,callback:function(t){e.legal_id=t},expression:"legal_id"}})],1)],1),e._v(" "),n("el-col",{attrs:{xs:24,sm:12,md:8,lg:8,xl:8}},[n("el-form-item",{attrs:{label:"Alias"}},[n("el-input",{model:{value:e.short_name,callback:function(t){e.short_name=t},expression:"short_name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"Tax code"}},[n("el-input",{model:{value:e.tax_code,callback:function(t){e.tax_code=t},expression:"tax_code"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"Registration number"}},[n("el-input",{model:{value:e.registration_number,callback:function(t){e.registration_number=t},expression:"registration_number"}})],1)],1)],1)],1),e._v(" "),n("el-button",{staticStyle:{"margin-left":"37px"},attrs:{disabled:e.$store.state.RMC.entitySearchLoading,type:"primary",size:"mini",icon:"el-icon-search"},on:{click:function(t){return e.$store.dispatch("RMC/searchEntity")}}},[e._v("\n    Search\n  ")])],1)},staticRenderFns:[]};var o=n("VU/8")(l,s,!1,function(e){n("zzfh")},"data-v-37b47df8",null);t.a=o.exports},je39:function(e,t,n){"use strict";var a=n("IcnI"),r={inserted:function(e,t,n){var r=t.value,i=a.a.getters&&a.a.getters.roles;if(!(r&&r instanceof Array&&r.length>0))throw new Error("need roles! Like v-permission=\"['admin','editor']\"");var l=r;i.some(function(e){return l.includes(e)})||e.parentNode&&e.parentNode.removeChild(e)}},i=function(e){e.directive("permission",r)};window.Vue&&(window.permission=r,Vue.use(i)),r.install=i;t.a=r},"o/9U":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("YdM+"),r=n("VhrE"),i={name:"RMCEntitySearch",components:{SearchCriteria:a.a,SearchResult:r.a},data:function(){return{activePanels:["criteria","result"]}}},l={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-collapse",{model:{value:e.activePanels,callback:function(t){e.activePanels=t},expression:"activePanels"}},[n("el-collapse-item",{attrs:{name:"criteria"}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-search"}),e._v(" "),n("span",{staticClass:"primary--text"},[e._v("  Search Criteria")])]),e._v(" "),n("SearchCriteria",{staticClass:"mt-1"})],2),e._v(" "),n("el-collapse-item",{attrs:{name:"result"}},[n("template",{slot:"title"},[n("i",{staticClass:"el-icon-check"}),e._v(" "),n("span",{staticClass:"primary--text"},[e._v("  Search Result")])]),e._v(" "),n("SearchResult",{staticClass:"mt-1",attrs:{"allow-create":"","allow-view":""}})],2)],1)},staticRenderFns:[]};var s=n("VU/8")(i,l,!1,function(e){n("HgUX")},"data-v-3963bd9c",null);t.default=s.exports},sWum:function(e,t){},zzfh:function(e,t){}});
//# sourceMappingURL=8.f600beafbbc54d227a5e.js.map